# SSQuant ç”¨æˆ·æ‰‹å†Œ

> å®Œæ•´çš„ä½¿ç”¨æ•™ç¨‹

## ğŸ“– ç›®å½•

1. [æ¡†æ¶æ¦‚è¿°](#æ¡†æ¶æ¦‚è¿°)
2. [å®‰è£…é…ç½®](#å®‰è£…é…ç½®)
3. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
4. [è´¦æˆ·é…ç½®](#è´¦æˆ·é…ç½®)
5. [ç­–ç•¥ç¼–å†™](#ç­–ç•¥ç¼–å†™)
6. [å›æµ‹æ¨¡å¼](#å›æµ‹æ¨¡å¼)
7. [SIMNOWæ¨¡æ‹Ÿ](#simnowæ¨¡æ‹Ÿ)
8. [å®ç›˜éƒ¨ç½²](#å®ç›˜éƒ¨ç½²)
9. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¡†æ¶æ¦‚è¿°

### æ ¸å¿ƒç†å¿µ

**ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„è¿è¡Œ** - åŒä¸€ä»½ç­–ç•¥ä»£ç å¯ä»¥åœ¨å›æµ‹ã€æ¨¡æ‹Ÿã€å®ç›˜ä¸‰ç§ç¯å¢ƒä¸‹è¿è¡Œã€‚

### ä¸‰ç§è¿è¡Œæ¨¡å¼

| æ¨¡å¼ | æšä¸¾å€¼ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|--------|------|---------|
| **å›æµ‹** | `RunMode.BACKTEST` | å†å²æ•°æ®å›æµ‹ | ç­–ç•¥å¼€å‘å’ŒéªŒè¯ |
| **æ¨¡æ‹Ÿ** | `RunMode.SIMNOW` | CTPæ¨¡æ‹Ÿç›˜ | å®ç›˜å‰æµ‹è¯• |
| **å®ç›˜** | `RunMode.REAL_TRADING` | çœŸå®CTPäº¤æ˜“ | æ­£å¼äº¤æ˜“ |

### æ•°æ®æµ

```
å›æµ‹æ¨¡å¼ï¼šå†å²æ•°æ® â†’ å›æµ‹å¼•æ“ â†’ ç­–ç•¥ â†’ æ¨¡æ‹Ÿæˆäº¤
SIMNOWï¼š  CTPè¡Œæƒ… â†’ å®æ—¶Kçº¿åˆæˆ â†’ ç­–ç•¥ â†’ æ¨¡æ‹Ÿä¸‹å•
å®ç›˜æ¨¡å¼ï¼šCTPè¡Œæƒ… â†’ å®æ—¶Kçº¿åˆæˆ â†’ ç­–ç•¥ â†’ çœŸå®ä¸‹å•
```

---

## å®‰è£…é…ç½®

### ç³»ç»Ÿè¦æ±‚

- **Python**: 3.9 ~ 3.14
- **æ“ä½œç³»ç»Ÿ**: Windows 10+ (CTPä»…æ”¯æŒWindows)
- **å†…å­˜**: 4GB+

### å®‰è£…æ–¹å¼

```bash
# æ–¹å¼1ï¼šä» PyPI å®‰è£…ï¼ˆæ¨èï¼‰
pip install ssquant

# æ–¹å¼2ï¼šä»æºç å®‰è£…
git clone https://github.com/songshuquant/ssquant-ai
cd ssquant-ai
pip install -e .
```

### å®‰è£…ä¾èµ–ï¼ˆå¯é€‰ï¼‰

```bash
# æœºå™¨å­¦ä¹ ç­–ç•¥éœ€è¦
pip install scikit-learn joblib statsmodels
```

### ç›®å½•ç»“æ„

```
ssquant/                    # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ ssquant/               # æ ¸å¿ƒåŒ…ï¼ˆpip installåå¯ç”¨ï¼‰
â”‚   â”œâ”€â”€ api/               # ç­–ç•¥API
â”‚   â”œâ”€â”€ backtest/          # å›æµ‹å¼•æ“  
â”‚   â”œâ”€â”€ config/            # é…ç½®ï¼ˆè´¦æˆ·é…ç½®åœ¨æ­¤ï¼‰
â”‚   â”œâ”€â”€ data/              # æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ pyctp/             # CTPæ¥å£å°è£…
â”‚   â”œâ”€â”€ ctp/               # CTPäºŒè¿›åˆ¶æ–‡ä»¶
â”‚   â””â”€â”€ indicators/        # æŠ€æœ¯æŒ‡æ ‡
â”œâ”€â”€ examples/              # ç¤ºä¾‹ç­–ç•¥ï¼ˆ19ä¸ªï¼‰
â”œâ”€â”€ data_cache/            # æ•°æ®ç¼“å­˜ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
â””â”€â”€ live_data/             # å®ç›˜æ•°æ®è½ç›˜ï¼ˆè¿è¡Œæ—¶ç”Ÿæˆï¼‰
```

---

## å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€ä¸ªç­–ç•¥ï¼ˆ3åˆ†é’Ÿï¼‰

**æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥æ–‡ä»¶ `my_first_strategy.py`**

```python
from ssquant.api.strategy_api import StrategyAPI
from ssquant.backtest.unified_runner import UnifiedStrategyRunner, RunMode
from ssquant.config.trading_config import get_config

def my_strategy(api: StrategyAPI):
    """ç®€å•çš„MAç­–ç•¥"""
    close = api.get_close()
    
    if len(close) < 20:
        return
    
    ma20 = close.rolling(20).mean()
    pos = api.get_pos()
    
    # ä»·æ ¼åœ¨å‡çº¿ä¸Šæ–¹åšå¤š
    if close.iloc[-1] > ma20.iloc[-1] and pos <= 0:
        if pos < 0:
            api.buycover(order_type='next_bar_open')
        api.buy(volume=1, order_type='next_bar_open')
        api.log("ä¹°å…¥ä¿¡å·")
    
    # ä»·æ ¼åœ¨å‡çº¿ä¸‹æ–¹åšç©º
    elif close.iloc[-1] < ma20.iloc[-1] and pos >= 0:
        if pos > 0:
            api.sell(order_type='next_bar_open')
        api.sellshort(volume=1, order_type='next_bar_open')
        api.log("å–å‡ºä¿¡å·")

if __name__ == "__main__":
    # å›æµ‹é…ç½®
    config = get_config(
        mode=RunMode.BACKTEST,
        symbol='rb888',               # ä¸»åŠ›è¿ç»­åˆçº¦
        start_date='2025-01-01',
        end_date='2025-11-30',
        kline_period='1h',            # 1å°æ—¶Kçº¿
        price_tick=1.0,               # æœ€å°å˜åŠ¨ä»·ä½
        contract_multiplier=10,       # åˆçº¦ä¹˜æ•°
        slippage_ticks=1,             # æ»‘ç‚¹
    )
    
    # è¿è¡Œ
    runner = UnifiedStrategyRunner(mode=RunMode.BACKTEST)
    runner.set_config(config)
    results = runner.run(strategy=my_strategy)
```

**æ­¥éª¤2ï¼šè¿è¡Œ**

```bash
python my_first_strategy.py
```

**å®Œæˆï¼** ä½ ä¼šçœ‹åˆ°å›æµ‹ç»“æœã€‚

---

## è´¦æˆ·é…ç½®

### é…ç½®æ–‡ä»¶ä½ç½®

`ssquant/config/trading_config.py`

### æ•°æ®APIé…ç½®

å¦‚æœéœ€è¦è‡ªåŠ¨è·å–å†å²æ•°æ®ï¼š

```python
# ç¼–è¾‘ trading_config.py
API_USERNAME = "ä½ çš„ç”¨æˆ·å"    # quant789.com è´¦å·
API_PASSWORD = "ä½ çš„å¯†ç "
```

### SIMNOWè´¦æˆ·é…ç½®

```python
ACCOUNTS = {
    'simnow_default': {
        # è´¦æˆ·è®¤è¯ (å¿…å¡«)
        'investor_id': 'ä½ çš„SIMNOWè´¦å·',   # simnow.com.cn æ³¨å†Œ
        'password': 'ä½ çš„å¯†ç ',
        'server_name': 'ç”µä¿¡1',             # æœåŠ¡å™¨: ç”µä¿¡1/ç”µä¿¡2/ç§»åŠ¨/TEST
        
        # äº¤æ˜“å‚æ•°
    'price_tick': 1.0,                  # æœ€å°å˜åŠ¨ä»·ä½
    'order_offset_ticks': 5,            # è¶…ä»·è·³æ•° (å¯¹äºå¸‚ä»·å•/next_bar_openæœ‰æ•ˆ)
    
    # æ™ºèƒ½ç®—æ³•äº¤æ˜“ (Algo Trading)
    'algo_trading': True,               # å¯ç”¨ç®—æ³•äº¤æ˜“
    'order_timeout': 10,                # è®¢å•è¶…æ—¶æ—¶é—´(ç§’)
    'retry_limit': 3,                   # æœ€å¤§é‡è¯•æ¬¡æ•°
    'retry_offset_ticks': 5,            # é‡è¯•æ—¶çš„è¶…ä»·è·³æ•°
    
    # æ•°æ®é…ç½®
    'preload_history': True,            # é¢„åŠ è½½å†å²Kçº¿
        'history_lookback_bars': 100,       # é¢„åŠ è½½æ•°é‡
        'adjust_type': '1',                 # å¤æƒ: 0ä¸å¤æƒ, 1åå¤æƒ
        
        # å›è°ƒé…ç½®
        'enable_tick_callback': False,      # TICKå›è°ƒæ¨¡å¼
        
        # æ•°æ®ä¿å­˜
        'save_kline_csv': False,
        'save_kline_db': False,
        'save_tick_csv': False,
        'save_tick_db': False,
    },
}
```

### å®ç›˜è´¦æˆ·é…ç½®

```python
ACCOUNTS = {
    'real_default': {
        # è´¦æˆ·è®¤è¯ (ä»æœŸè´§å…¬å¸è·å–)
        'broker_id': 'æœŸè´§å…¬å¸ä»£ç ',
        'investor_id': 'èµ„é‡‘è´¦å·',
        'password': 'äº¤æ˜“å¯†ç ',
        'md_server': 'tcp://xxx.xxx.xxx.xxx:port',  # è¡Œæƒ…æœåŠ¡å™¨
        'td_server': 'tcp://xxx.xxx.xxx.xxx:port',  # äº¤æ˜“æœåŠ¡å™¨
        'app_id': 'åº”ç”¨ID',
        'auth_code': 'æˆæƒç ',
        
        # å…¶ä»–å‚æ•°åŒ simnow_default
    },
}
```

### ä½¿ç”¨è´¦æˆ·

```python
# SIMNOW
config = get_config(
    mode=RunMode.SIMNOW,
    account='simnow_default',   # ä½¿ç”¨é…ç½®å¥½çš„è´¦æˆ·
    symbol='rb2601',
)

# å®ç›˜
config = get_config(
    mode=RunMode.REAL_TRADING,
    account='real_default',     # ä½¿ç”¨é…ç½®å¥½çš„è´¦æˆ·
    symbol='rb2601',
)
```

---

## ç­–ç•¥ç¼–å†™

### ç­–ç•¥å‡½æ•°ç»“æ„

```python
def my_strategy(api: StrategyAPI):
    """
    ç­–ç•¥å‡½æ•° - æ¯æ ¹Kçº¿æ‰§è¡Œä¸€æ¬¡
    
    Args:
        api: ç­–ç•¥APIå¯¹è±¡
    """
    # 1. è·å–æ•°æ®
    close = api.get_close()
    
    # 2. æ•°æ®éªŒè¯
    if len(close) < 20:
        return
    
    # 3. è®¡ç®—æŒ‡æ ‡
    ma20 = close.rolling(20).mean()
    
    # 4. è·å–æŒä»“
    pos = api.get_pos()
    
    # 5. äº¤æ˜“ä¿¡å·
    if close.iloc[-1] > ma20.iloc[-1]:
        if pos <= 0:
            api.buy(volume=1, order_type='next_bar_open')
```

### åˆå§‹åŒ–å‡½æ•°ï¼ˆå¯é€‰ï¼‰

```python
def initialize(api: StrategyAPI):
    """ç­–ç•¥åˆå§‹åŒ– - è¿è¡Œå‰æ‰§è¡Œä¸€æ¬¡"""
    api.log("ç­–ç•¥åˆå§‹åŒ–")
    fast = api.get_param('fast_ma', 5)
    slow = api.get_param('slow_ma', 20)
    api.log(f"å‚æ•°: å¿«çº¿={fast}, æ…¢çº¿={slow}")

# è¿è¡Œæ—¶ä¼ å…¥
runner.run(
    strategy=my_strategy,
    initialize=initialize,
    strategy_params={'fast_ma': 5, 'slow_ma': 20}
)
```

### å¸¸ç”¨API

```python
# ===== æ•°æ®è·å– =====
api.get_close()          # æ”¶ç›˜ä»·åºåˆ—
api.get_open()           # å¼€ç›˜ä»·åºåˆ—
api.get_high()           # æœ€é«˜ä»·åºåˆ—
api.get_low()            # æœ€ä½ä»·åºåˆ—
api.get_volume()         # æˆäº¤é‡åºåˆ—
api.get_klines()         # å®Œæ•´Kçº¿DataFrame
api.get_price()          # å½“å‰ä»·æ ¼
api.get_datetime()       # å½“å‰æ—¶é—´
api.get_idx()            # å½“å‰Kçº¿ç´¢å¼•

# ===== æŒä»“æŸ¥è¯¢ =====
api.get_pos()            # å‡€æŒä»“ï¼ˆæ­£=å¤šï¼Œè´Ÿ=ç©ºï¼‰
api.get_long_pos()       # å¤šå¤´æŒä»“
api.get_short_pos()      # ç©ºå¤´æŒä»“
api.get_position_detail()# è¯¦ç»†æŒä»“ï¼ˆä»Šæ˜¨ä»“ï¼‰

# ===== äº¤æ˜“æ“ä½œ =====
api.buy(volume=1)        # ä¹°å…¥å¼€ä»“
api.sell()               # å–å‡ºå¹³ä»“ï¼ˆå¹³å¤šï¼‰
api.sellshort(volume=1)  # å–å‡ºå¼€ä»“ï¼ˆå¼€ç©ºï¼‰
api.buycover()           # ä¹°å…¥å¹³ä»“ï¼ˆå¹³ç©ºï¼‰
api.close_all()          # å…¨éƒ¨å¹³ä»“
api.reverse_pos()        # åæ‰‹

# ===== å‚æ•°å’Œæ—¥å¿— =====
api.get_param('key', default)  # è·å–å‚æ•°
api.log("æ¶ˆæ¯")                # è®°å½•æ—¥å¿—

# ===== TICKæ•°æ®ï¼ˆå®ç›˜ï¼‰ =====
api.get_tick()           # å½“å‰TICK
api.get_ticks(100)       # æœ€è¿‘100ä¸ªTICK
```

è¯¦è§ [APIå‚è€ƒæ‰‹å†Œ.md](APIå‚è€ƒæ‰‹å†Œ.md)

---

## å›æµ‹æ¨¡å¼

### åŸºæœ¬é…ç½®

```python
from ssquant.backtest.unified_runner import UnifiedStrategyRunner, RunMode
from ssquant.config.trading_config import get_config

config = get_config(
    mode=RunMode.BACKTEST,
    
    # åˆçº¦é…ç½®
    symbol='rb888',               # ä¸»åŠ›è¿ç»­åˆçº¦
    start_date='2025-01-01',      # å¼€å§‹æ—¥æœŸ
    end_date='2025-11-30',        # ç»“æŸæ—¥æœŸ
    kline_period='1h',            # Kçº¿å‘¨æœŸ: 1m/5m/15m/30m/1h/4h/1d
    adjust_type='1',              # å¤æƒ: 0ä¸å¤æƒ, 1åå¤æƒ
    
    # åˆçº¦å‚æ•°
    price_tick=1.0,               # æœ€å°å˜åŠ¨ä»·ä½
    contract_multiplier=10,       # åˆçº¦ä¹˜æ•°
    slippage_ticks=1,             # æ»‘ç‚¹è·³æ•°
    
    # èµ„é‡‘å‚æ•°
    initial_capital=100000,       # åˆå§‹èµ„é‡‘
    commission=0.0001,            # æ‰‹ç»­è´¹ç‡
    margin_rate=0.1,              # ä¿è¯é‡‘ç‡
)

runner = UnifiedStrategyRunner(mode=RunMode.BACKTEST)
runner.set_config(config)
results = runner.run(strategy=my_strategy)
```

### å¤šå“ç§å›æµ‹

```python
config = get_config(
    mode=RunMode.BACKTEST,
    start_date='2025-01-01',
    end_date='2025-11-30',
    
    data_sources=[
        {
            'symbol': 'rb888',
            'kline_period': '1h',
            'price_tick': 1.0,
            'contract_multiplier': 10,
        },
        {
            'symbol': 'i888',
            'kline_period': '1h',
            'price_tick': 0.5,
            'contract_multiplier': 100,
        },
    ],
)

# ç­–ç•¥ä¸­è®¿é—®ä¸åŒæ•°æ®æº
def multi_symbol_strategy(api):
    close_rb = api.get_close(index=0)  # rb
    close_i = api.get_close(index=1)   # i
    
    api.buy(volume=1, index=0)  # åœ¨rbä¸Šäº¤æ˜“
    api.buy(volume=1, index=1)  # åœ¨iä¸Šäº¤æ˜“
```

### å¤šå‘¨æœŸå›æµ‹

```python
config = get_config(
    mode=RunMode.BACKTEST,
    start_date='2025-01-01',
    end_date='2025-11-30',
    
    data_sources=[
        {'symbol': 'rb888', 'kline_period': '5m'},
        {'symbol': 'rb888', 'kline_period': '1h'},
    ],
)

# ç­–ç•¥ä¸­ä½¿ç”¨å¤šå‘¨æœŸ
def multi_period_strategy(api):
    close_5m = api.get_close(index=0)   # 5åˆ†é’Ÿ
    close_1h = api.get_close(index=1)   # 1å°æ—¶
    
    # ç”¨1å°æ—¶åˆ¤æ–­è¶‹åŠ¿ï¼Œ5åˆ†é’Ÿè¿›åœº
```

è¯¦è§ [å›æµ‹æ•™ç¨‹.md](å›æµ‹æ•™ç¨‹.md)

---

## SIMNOWæ¨¡æ‹Ÿ

### ç”³è¯·è´¦å·

è®¿é—® http://www.simnow.com.cn/ æ³¨å†Œå…è´¹è´¦å·

### é…ç½®è´¦æˆ·

ç¼–è¾‘ `ssquant/config/trading_config.py`ï¼š

```python
ACCOUNTS = {
    'simnow_default': {
        'investor_id': 'ä½ çš„SIMNOWè´¦å·',
        'password': 'ä½ çš„å¯†ç ',
        'server_name': 'ç”µä¿¡1',
        # ...
    },
}
```

### è¿è¡Œç­–ç•¥

```python
config = get_config(
    mode=RunMode.SIMNOW,
    account='simnow_default',
    
    # åˆçº¦é…ç½®
    symbol='rb2601',              # å…·ä½“åˆçº¦ï¼ˆä¸èƒ½ç”¨ä¸»è¿888ï¼‰
    kline_period='1m',            # Kçº¿å‘¨æœŸ
    
    # äº¤æ˜“å‚æ•°
    price_tick=1.0,               # æœ€å°å˜åŠ¨ä»·ä½
    order_offset_ticks=5,         # è¶…ä»·è·³æ•°ï¼ˆç¡®ä¿æˆäº¤ï¼‰
    
    # æ™ºèƒ½ç®—æ³•äº¤æ˜“
    algo_trading=True,            # å¯ç”¨ç®—æ³•äº¤æ˜“
    order_timeout=10,             # 10ç§’è¶…æ—¶
    retry_limit=3,                # é‡è¯•3æ¬¡
    retry_offset_ticks=5,         # é‡è¯•åç§»
    
    # å†å²æ•°æ®
    preload_history=True,         # é¢„åŠ è½½å†å²Kçº¿
    history_lookback_bars=100,    # é¢„åŠ è½½æ•°é‡
    adjust_type='1',              # å¤æƒç±»å‹
    
    # å›è°ƒæ¨¡å¼
    enable_tick_callback=False,   # False=Kçº¿é©±åŠ¨ï¼ŒTrue=TICKé©±åŠ¨
    
    # æ•°æ®ä¿å­˜
    save_kline_csv=True,          # ä¿å­˜Kçº¿åˆ°CSV
    save_tick_csv=True,           # ä¿å­˜TICKåˆ°CSV
)

runner = UnifiedStrategyRunner(mode=RunMode.SIMNOW)
runner.set_config(config)
runner.run(strategy=my_strategy)
```

### æœåŠ¡å™¨é€‰æ‹©

| server_name | è¯´æ˜ |
|------------|------|
| `'ç”µä¿¡1'` | ç”µä¿¡ç”¨æˆ·ä¼˜å…ˆ |
| `'ç”µä¿¡2'` | å¤‡ç”¨çº¿è·¯ |
| `'ç§»åŠ¨'` | ç§»åŠ¨ç”¨æˆ·ä¼˜å…ˆ |
| `'TEST'` | æµ‹è¯•æœåŠ¡å™¨ï¼ˆå‘¨æœ«å¯ç”¨ï¼‰ |

è¯¦è§ [SIMNOWä½¿ç”¨æŒ‡å—.md](SIMNOWä½¿ç”¨æŒ‡å—.md)

---

## å®ç›˜éƒ¨ç½²

### âš ï¸ å®‰å…¨è­¦å‘Š

**å®ç›˜å‰å¿…è¯»ï¼š**

1. âœ… åœ¨SIMNOWå……åˆ†æµ‹è¯•ï¼ˆè‡³å°‘1å‘¨ï¼‰
2. âœ… å…ˆç”¨æœ€å°æ‰‹æ•°ï¼ˆ1æ‰‹ï¼‰éªŒè¯
3. âœ… è®¾ç½®æ­¢æŸ/æ­¢ç›ˆ
4. âœ… ç›‘æ§ç­–ç•¥è¿è¡ŒçŠ¶æ€
5. âœ… å‡†å¤‡ç´§æ€¥åœæ­¢æ–¹æ¡ˆ

### é…ç½®å®ç›˜è´¦æˆ·

ç¼–è¾‘ `ssquant/config/trading_config.py`ï¼š

```python
ACCOUNTS = {
    'real_default': {
        'broker_id': 'æœŸè´§å…¬å¸ä»£ç ',        # å¦‚ '9999'
        'investor_id': 'èµ„é‡‘è´¦å·',
        'password': 'äº¤æ˜“å¯†ç ',
        'md_server': 'tcp://xxx:port',     # è¡Œæƒ…æœåŠ¡å™¨
        'td_server': 'tcp://xxx:port',     # äº¤æ˜“æœåŠ¡å™¨
        'app_id': 'AppID',
        'auth_code': 'æˆæƒç ',
        # ...
    },
}
```

### è¿è¡Œå®ç›˜

```python
config = get_config(
    mode=RunMode.REAL_TRADING,
    account='real_default',
    symbol='rb2601',
    kline_period='1m',
    price_tick=1.0,
    order_offset_ticks=5,
    preload_history=True,
    history_lookback_bars=100,
)

runner = UnifiedStrategyRunner(mode=RunMode.REAL_TRADING)
runner.set_config(config)

try:
    runner.run(strategy=my_strategy)
except KeyboardInterrupt:
    runner.stop()
    print("ç­–ç•¥å·²åœæ­¢")
```

è¯¦è§ [å®ç›˜éƒ¨ç½²æŒ‡å—.md](å®ç›˜éƒ¨ç½²æŒ‡å—.md)

---

### 7. é«˜çº§äº¤æ˜“åŠŸèƒ½

#### 7.1 é™ä»·å•ä¸Makerç­–ç•¥
é™¤äº†é»˜è®¤çš„Kçº¿æˆäº¤å’Œå¸‚ä»·å•ï¼Œæ¡†æ¶è¿˜æ”¯æŒå‘é€çº¯é™ä»·å•ï¼ˆLimit Orderï¼‰ï¼š

```python
# æŒ‡å®š order_type='limit' å¹¶æä¾›ä»·æ ¼
api.buy(volume=1, order_type='limit', price=3500.0)

# æˆ–è€…ç›´æ¥æä¾›ä»·æ ¼ (è‡ªåŠ¨è¯†åˆ«ä¸ºé™ä»·å•)
api.sell(volume=1, price=3600.0)
```

é…åˆ **æ™ºèƒ½ç®—æ³•äº¤æ˜“** é…ç½®ï¼Œå¯ä»¥å®ç° "å…ˆæ’é˜Ÿ(Maker)ï¼Œè¶…æ—¶ååƒå•(Taker)" çš„é«˜çº§ç­–ç•¥ï¼š
1. ç­–ç•¥å‘å‡ºé™ä»·å•ï¼ŒæŒ‚åœ¨ä¹°ä¸€ä»·ä¸Šæ’é˜Ÿã€‚
2. è®¾ç½® `order_timeout=5`ï¼Œå¦‚æœ5ç§’å†…æœªæˆäº¤ï¼Œæ¡†æ¶è‡ªåŠ¨æ’¤å•ã€‚
3. è®¾ç½® `retry_offset_ticks=5`ï¼Œæ’¤å•åæ¡†æ¶è‡ªåŠ¨ä»¥ "å¯¹æ‰‹ä»·+5è·³" å‘å‡ºæ–°è®¢å•ï¼Œç¡®ä¿æˆäº¤ã€‚

#### 7.2 æ™ºèƒ½ç®—æ³•äº¤æ˜“å‚æ•°
åœ¨ `get_config` ä¸­é…ç½®ï¼š
- `algo_trading`: æ˜¯å¦å¼€å¯æ™ºèƒ½äº¤æ˜“ç®—æ³• (True/False)
- `order_timeout`: è®¢å•è¶…æ—¶æ—¶é—´(ç§’)ï¼Œ0è¡¨ç¤ºä¸è¶…æ—¶
- `retry_limit`: æ’¤å•åå°è¯•é‡å‘çš„æœ€å¤§æ¬¡æ•°
- `retry_offset_ticks`: é‡å‘æ—¶çš„ä»·æ ¼åç§»è·³æ•° (ç›¸å¯¹äºå¯¹æ‰‹ä»·)

---

### 8. å¸¸è§é—®é¢˜ (FAQ)

### Q1: æ‰¾ä¸åˆ°æ•°æ®ï¼Ÿ

**A:** æ£€æŸ¥ï¼š
- symbolä»£ç æ˜¯å¦æ­£ç¡®ï¼ˆå¦‚`rb888`ï¼‰
- æ—¥æœŸèŒƒå›´æ˜¯å¦æœ‰æ•ˆ
- APIè´¦å·å¯†ç æ˜¯å¦åœ¨ `trading_config.py` ä¸­é…ç½®

### Q2: ç­–ç•¥ä¸æ‰§è¡Œï¼Ÿ

**A:** æ£€æŸ¥ï¼š
- æ•°æ®é•¿åº¦æ˜¯å¦è¶³å¤Ÿï¼ˆMA20éœ€è¦è‡³å°‘20æ ¹Kçº¿ï¼‰
- æ˜¯å¦æœ‰æ—©æœŸè¿”å›ï¼ˆreturnï¼‰
- æ·»åŠ  `api.log()` è°ƒè¯•

### Q3: æŒä»“ä¸å¯¹ï¼Ÿ

**A:** æ£€æŸ¥ï¼š
- `order_type` æ˜¯å¦æ­£ç¡®
- å›æµ‹ç”¨ `'next_bar_open'`ï¼Œå®ç›˜ç”¨ `'market'`
- å®ç›˜æ£€æŸ¥ `order_offset_ticks` è®¾ç½®

### Q4: å›æµ‹å’Œå®ç›˜ç»“æœå·®å¼‚å¤§ï¼Ÿ

**A:** å¯èƒ½åŸå› ï¼š
- `adjust_type` å¤æƒç±»å‹ä¸ä¸€è‡´
- `slippage_ticks` æ»‘ç‚¹è®¾ç½®ä¸åˆç†
- `price_tick` æœ€å°å˜åŠ¨ä»·ä½è®¾ç½®é”™è¯¯

### Q5: SIMNOWè¿æ¥å¤±è´¥ï¼Ÿ

**A:** å°è¯•ï¼š
- æ›´æ¢æœåŠ¡å™¨ï¼ˆç”µä¿¡1 â†’ ç”µä¿¡2 â†’ ç§»åŠ¨ï¼‰
- æ£€æŸ¥è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å·¥ä½œæ—¥9:00-15:30æµ‹è¯•

### Q6: å¦‚ä½•æ·»åŠ æ–°è´¦æˆ·ï¼Ÿ

**A:** ç¼–è¾‘ `ssquant/config/trading_config.py`ï¼š

```python
ACCOUNTS = {
    'simnow_default': {...},
    'my_new_account': {        # æ·»åŠ æ–°è´¦æˆ·
        'investor_id': 'xxx',
        'password': 'xxx',
        # ...
    },
}
```

---

## å­¦ä¹ è·¯å¾„

### åˆå­¦è€…ï¼ˆç¬¬1å‘¨ï¼‰

1. é˜…è¯»æœ¬æ‰‹å†Œ
2. è¿è¡Œ `examples/B_åŒå‡çº¿ç­–ç•¥.py`
3. ä¿®æ”¹å‚æ•°ï¼Œè§‚å¯Ÿç»“æœ
4. å°è¯•ç¼–å†™ç®€å•ç­–ç•¥

### è¿›é˜¶ï¼ˆç¬¬2-4å‘¨ï¼‰

1. å­¦ä¹ å¤šå“ç§ç­–ç•¥ `B_å¤šå“ç§å¤šå‘¨æœŸäº¤æ˜“ç­–ç•¥.py`
2. å°è¯•SIMNOWæ¨¡æ‹Ÿ
3. ç ”ç©¶é«˜çº§ç¤ºä¾‹ï¼ˆæµ·é¾Ÿã€å¥—åˆ©ï¼‰
4. å‚æ•°ä¼˜åŒ– `B_å¤šå“ç§å¤šå‘¨æœŸäº¤æ˜“ç­–ç•¥_å‚æ•°ä¼˜åŒ–.py`

### é«˜çº§ï¼ˆç¬¬5å‘¨+ï¼‰

1. TICKæµç­–ç•¥ `C_çº¯Tické«˜é¢‘äº¤æ˜“ç­–ç•¥.py`
2. æœºå™¨å­¦ä¹ ç­–ç•¥ `B_æœºå™¨å­¦ä¹ ç­–ç•¥_éšæœºæ£®æ—.py`
3. å®ç›˜å°èµ„é‡‘æµ‹è¯•
4. æ­£å¼éƒ¨ç½²

---

## æœ€ä½³å®è·µ

### å¼€å‘æµç¨‹

```
ç­–ç•¥æ„æ€ â†’ å›æµ‹éªŒè¯ â†’ SIMNOWæµ‹è¯• â†’ å°èµ„é‡‘å®ç›˜ â†’ æ­£å¼è¿è¡Œ
   â†‘_____________|ï¼ˆå‘ç°é—®é¢˜ï¼Œä¼˜åŒ–ç­–ç•¥ï¼‰
```

### é£é™©æ§åˆ¶

```python
def strategy_with_stoploss(api):
    close = api.get_close()
    pos = api.get_pos()
    
    # æ­¢æŸï¼šäºæŸ5%
    entry_price = api.get_param('entry_price', 0)
    if pos > 0 and entry_price > 0:
        if close.iloc[-1] < entry_price * 0.95:
            api.sell(order_type='next_bar_open', reason='æ­¢æŸ')
```

### å‚æ•°ç®¡ç†

```python
strategy_params = {
    'fast_ma': 5,
    'slow_ma': 20,
    'stop_loss': 0.05,
}

runner.run(
    strategy=my_strategy,
    strategy_params=strategy_params
)
```

---

## ä¸‹ä¸€æ­¥

- æŸ¥çœ‹ [APIå‚è€ƒæ‰‹å†Œ.md](APIå‚è€ƒæ‰‹å†Œ.md) äº†è§£å®Œæ•´API
- æŸ¥çœ‹ [æ•°æ®ç®¡ç†æŒ‡å—.md](æ•°æ®ç®¡ç†æŒ‡å—.md) äº†è§£æ•°æ®è·å–
- æŸ¥çœ‹ `examples/` å­¦ä¹ ç¤ºä¾‹ç­–ç•¥

---

**ç¥ä½ é‡åŒ–äº¤æ˜“æˆåŠŸï¼** ğŸ“ˆ
